- name: Calcular nova versão e branch
        id: bump_version
        run: |
          tag="${{ steps.find_tag.outputs.latest_tag }}"
          increment_type="${{ github.event.inputs.increment_type }}"
          
          echo "🔨 Gerando nova versão a partir de tag: $tag"
          echo "➡️  Tipo de incremento: $increment_type"
          
          version=$(echo "$tag" | sed 's/release\///')
          
          major=$(echo "$version" | cut -d'.' -f1)
          minor=$(echo "$version" | cut -d'.' -f2)
          patch=$(echo "$version" | cut -d'.' -f3)

          case "$increment_type" in
            major)
              ((major++)); minor=0; patch=0 ;;
            minor)
              ((minor++)); patch=0 ;;
            patch)
              ((patch++)) ;;
            *)
              echo "Incremento inválido: $increment_type"; exit 1 ;;
          esac
          
          new_ver="$major.$minor.$patch"
          new_branch="release/$new_ver"
          
          echo "new_version=$new_ver" >> $GITHUB_OUTPUT
          echo "new_branch=$new_branch" >> $GITHUB_OUTPUT
